{
  "author": "FinleyGe",
  "version": "4811",
  "name": "SVG 图片输出",
  "avatar": "core/chat/imgSelect",
  "intro": "",
  "showStatus": false,
  "weight": 10,
  "isTool": true,
  "templateType": "tools",
  "workflow": {
    "nodes": [
      {
        "nodeId": "pluginInput",
        "name": "workflow:template.plugin_start",
        "intro": "workflow:intro_plugin_input",
        "avatar": "core/workflow/template/workflowStart",
        "flowNodeType": "pluginInput",
        "showStatus": false,
        "position": {
          "x": 612.6041682713143,
          "y": -216.05298493910115
        },
        "version": "481",
        "inputs": [
          {
            "renderTypeList": [
              "textarea"
            ],
            "selectedTypeIndex": 0,
            "valueType": "string",
            "canEdit": true,
            "key": "svg",
            "label": "svg",
            "description": "",
            "defaultValue": "",
            "list": [
              {
                "label": "",
                "value": ""
              }
            ],
            "required": false
          }
        ],
        "outputs": [
          {
            "id": "svg",
            "valueType": "string",
            "key": "svg",
            "label": "svg",
            "type": "hidden"
          }
        ]
      },
      {
        "nodeId": "pluginOutput",
        "name": "common:core.module.template.self_output",
        "intro": "workflow:intro_custom_plugin_output",
        "avatar": "core/workflow/template/pluginOutput",
        "flowNodeType": "pluginOutput",
        "showStatus": false,
        "position": {
          "x": 2059.5661138406194,
          "y": -164.55298493910118
        },
        "version": "481",
        "inputs": [
          {
            "renderTypeList": [
              "reference"
            ],
            "valueType": "string",
            "canEdit": true,
            "key": "pic",
            "label": "pic",
            "isToolOutput": true,
            "description": "",
            "value": [
              "xT02INFUpn9n",
              "system_text"
            ]
          }
        ],
        "outputs": []
      },
      {
        "nodeId": "pluginConfig",
        "name": "common:core.module.template.system_config",
        "intro": "",
        "avatar": "core/workflow/template/systemConfig",
        "flowNodeType": "pluginConfig",
        "position": {
          "x": 184.66337662472682,
          "y": -216.05298493910115
        },
        "version": "4811",
        "inputs": [],
        "outputs": []
      },
      {
        "nodeId": "zwZuMToyJZQl",
        "name": "代码运行",
        "intro": "执行一段简单的脚本代码，通常用于进行复杂的数据处理。",
        "avatar": "core/workflow/template/codeRun",
        "flowNodeType": "code",
        "showStatus": true,
        "position": {
          "x": 1035.9735002229265,
          "y": -462.5529849391012
        },
        "version": "482",
        "inputs": [
          {
            "key": "system_addInputParam",
            "renderTypeList": [
              "addInputParam"
            ],
            "valueType": "dynamic",
            "label": "",
            "required": false,
            "description": "workflow:these_variables_will_be_input_parameters_for_code_execution",
            "customInputConfig": {
              "selectValueTypeList": [
                "string",
                "number",
                "boolean",
                "object",
                "arrayString",
                "arrayNumber",
                "arrayBoolean",
                "arrayObject",
                "arrayAny",
                "any",
                "chatHistory",
                "datasetQuote",
                "dynamic",
                "selectApp",
                "selectDataset"
              ],
              "showDescription": false,
              "showDefaultValue": true
            },
            "valueDesc": "",
            "debugLabel": "",
            "toolDescription": ""
          },
          {
            "key": "codeType",
            "renderTypeList": [
              "hidden"
            ],
            "label": "",
            "value": "js",
            "valueDesc": "",
            "description": "",
            "debugLabel": "",
            "toolDescription": ""
          },
          {
            "key": "code",
            "renderTypeList": [
              "custom"
            ],
            "label": "",
            "value": "var Base64={_keyStr:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",encode:function(e){var t=\"\";var n,r,i,s,o,u,a;var f=0;e=Base64._utf8_encode(e);while(f<e.length){n=e.charCodeAt(f++);r=e.charCodeAt(f++);i=e.charCodeAt(f++);s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)}return t},decode:function(e){var t=\"\";var n,r,i;var s,o,u,a;var f=0;e=e.replace(/[^A-Za-z0-9\\+\\/\\=]/g,\"\");while(f<e.length){s=this._keyStr.indexOf(e.charAt(f++));o=this._keyStr.indexOf(e.charAt(f++));u=this._keyStr.indexOf(e.charAt(f++));a=this._keyStr.indexOf(e.charAt(f++));n=s<<2|o>>4;r=(o&15)<<4|u>>2;i=(u&3)<<6|a;t=t+String.fromCharCode(n);if(u!=64){t=t+String.fromCharCode(r)}if(a!=64){t=t+String.fromCharCode(i)}}t=Base64._utf8_decode(t);return t},_utf8_encode:function(e){e=e.replace(/\\r\\n/g,\"\\n\");var t=\"\";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r)}else if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(r&63|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(r&63|128)}}return t},_utf8_decode:function(e){var t=\"\";var n=0;var r=c1=c2=0;while(n<e.length){r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r);n++}else if(r>191&&r<224){c2=e.charCodeAt(n+1);t+=String.fromCharCode((r&31)<<6|c2&63);n+=2}else{c2=e.charCodeAt(n+1);c3=e.charCodeAt(n+2);t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63);n+=3}}return t}}\n\nfunction main({svg}){\n    const base64 = Base64.encode(svg.replaceAll('\\\"', '\"'));\n    return {\n        base64\n    }\n}",
            "valueDesc": "",
            "description": "",
            "debugLabel": "",
            "toolDescription": ""
          },
          {
            "renderTypeList": [
              "reference"
            ],
            "valueType": "string",
            "canEdit": true,
            "key": "svg",
            "label": "svg",
            "customInputConfig": {
              "selectValueTypeList": [
                "string",
                "number",
                "boolean",
                "object",
                "arrayString",
                "arrayNumber",
                "arrayBoolean",
                "arrayObject",
                "arrayAny",
                "any",
                "chatHistory",
                "datasetQuote",
                "dynamic",
                "selectApp",
                "selectDataset"
              ],
              "showDescription": false,
              "showDefaultValue": true
            },
            "required": true,
            "value": [
              "pluginInput",
              "svg"
            ]
          }
        ],
        "outputs": [
          {
            "id": "system_rawResponse",
            "key": "system_rawResponse",
            "label": "workflow:full_response_data",
            "valueType": "object",
            "type": "static",
            "description": ""
          },
          {
            "id": "error",
            "key": "error",
            "label": "workflow:execution_error",
            "description": "代码运行错误信息，成功时返回空",
            "valueType": "object",
            "type": "static"
          },
          {
            "id": "system_addOutputParam",
            "key": "system_addOutputParam",
            "type": "dynamic",
            "valueType": "dynamic",
            "label": "",
            "customFieldConfig": {
              "selectValueTypeList": [
                "string",
                "number",
                "boolean",
                "object",
                "arrayString",
                "arrayNumber",
                "arrayBoolean",
                "arrayObject",
                "arrayAny",
                "any",
                "chatHistory",
                "datasetQuote",
                "dynamic",
                "selectApp",
                "selectDataset"
              ],
              "showDescription": false,
              "showDefaultValue": false
            },
            "description": "将代码中 return 的对象作为输出，传递给后续的节点。变量名需要对应 return 的 key",
            "valueDesc": ""
          },
          {
            "id": "yhPKEZPu43qN",
            "valueType": "string",
            "type": "dynamic",
            "key": "base64",
            "label": "base64"
          }
        ]
      },
      {
        "nodeId": "xT02INFUpn9n",
        "name": "文本拼接",
        "intro": "可对固定或传入的文本进行加工后输出，非字符串类型数据最终会转成字符串类型。",
        "avatar": "core/workflow/template/textConcat",
        "flowNodeType": "textEditor",
        "position": {
          "x": 1503.4551398439608,
          "y": -279.5529849391012
        },
        "version": "486",
        "inputs": [
          {
            "key": "system_addInputParam",
            "renderTypeList": [
              "addInputParam"
            ],
            "valueType": "dynamic",
            "label": "",
            "required": false,
            "description": "workflow:dynamic_input_description_concat",
            "customInputConfig": {
              "selectValueTypeList": [
                "string",
                "number",
                "boolean",
                "object",
                "arrayString",
                "arrayNumber",
                "arrayBoolean",
                "arrayObject",
                "arrayAny",
                "any",
                "chatHistory",
                "datasetQuote",
                "dynamic",
                "selectApp",
                "selectDataset"
              ],
              "showDescription": false,
              "showDefaultValue": false
            },
            "valueDesc": "",
            "debugLabel": "",
            "toolDescription": ""
          },
          {
            "key": "system_textareaInput",
            "renderTypeList": [
              "textarea"
            ],
            "valueType": "string",
            "required": true,
            "label": "拼接文本",
            "placeholder": "workflow:input_variable_list",
            "valueDesc": "",
            "description": "",
            "debugLabel": "",
            "toolDescription": "",
            "value": "![图片](data:image/svg+xml;base64,{{$zwZuMToyJZQl.yhPKEZPu43qN$}})"
          }
        ],
        "outputs": [
          {
            "id": "system_text",
            "key": "system_text",
            "label": "workflow:concatenation_result",
            "type": "static",
            "valueType": "string",
            "description": ""
          }
        ]
      }
    ],
    "edges": [
      {
        "source": "pluginInput",
        "target": "zwZuMToyJZQl",
        "sourceHandle": "pluginInput-source-right",
        "targetHandle": "zwZuMToyJZQl-target-left"
      },
      {
        "source": "zwZuMToyJZQl",
        "target": "xT02INFUpn9n",
        "sourceHandle": "zwZuMToyJZQl-source-right",
        "targetHandle": "xT02INFUpn9n-target-left"
      },
      {
        "source": "xT02INFUpn9n",
        "target": "pluginOutput",
        "sourceHandle": "xT02INFUpn9n-source-right",
        "targetHandle": "pluginOutput-target-left"
      }
    ],
    "chatConfig": {
      "welcomeText": "",
      "variables": [],
      "questionGuide": false,
      "ttsConfig": {
        "type": "web"
      },
      "whisperConfig": {
        "open": false,
        "autoSend": false,
        "autoTTSResponse": false
      },
      "chatInputGuide": {
        "open": false,
        "textList": [],
        "customUrl": ""
      },
      "instruction": "输入为一个 <svg></svg> 标签，输出为一个markdown格式的图片，图片内容为 base64 编码的 svg",
      "_id": "6719c2524c7dca2a7c3a67c4"
    }
  }
}
